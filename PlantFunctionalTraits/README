Fast_mvSLOUCH_example.zip contains the script (Fast_mvSLOUCH_example.R), inputs and outputs 
for the large plant dataset analysed in the paper.


1. After extraction of the zip folder from github, place the folder where you seek to perform analyses.

2. Set the working directory to this folder - setwd()

3. Open the Fast_mvSLOUCH_example.R script in R

4. If you want to run everything again (it will take at least 2 weeks using 6 cores on a laptop), set
runtype <- "novel.run"
at the top of the code. This will overwrite any outputs already in the folder, only drawing data from
the INPUTS folder. You may find it easier therefore, to delete or move all files and folders except for
the INPUTS FOLDER and this script.

5. If you wish to run the code without fitting the models, but by loading our model outputs as presented in the paper, set:
runtype <- "load.previous.outputs"
This will enable you to examine our outputs within R.

Rows with file / folder names are indicated with *


* "Fast_mvSLOUCH_example.R" 

  
* "INPUTS"  
* "plant tree for mvSLOUCH.tre" - land plant phylogeny
* "4plant.traits.w.Ellenberg.values.rds" - four anatomical traits for all of the taxa in the phylogeny


* "Regimes.on.tree_6.pdf" - A figure with Ellenberg values mapped onto the plant phylogeny 

                  
Default usage of models in mvSLOUCH
To demonstrate the different models in mvSLOUCH, a variety of models in the package were fit to the data set,
prior to fitting the customised models (where the A and Syy matrices were defined to fit very specific hypotheses).
These models were:
 
* "BM1.output.txt"  "BM1.rds"  "BM1.seed.rds" - BM (multivariate Brownian motion) output and seed

* "OU1.output.txt"  "OU1.rds"  "OU1.seed.rds" - OU (multivariate  OU) output and seed

* "OUestim.output.txt"  "OUestim.rds"  "OUestim.seed.rds" - OU (multivariate  OU) with regimes (for each Ellenberg value) 
                          
* "OU1BM.output.txt"  "OU1BM.rds"  "OU1BM.seed.rds" - OUBM (multivariate OUBM)

* "OUBMestim .rds"  "OUBMestim.output.txt"  "OUBMestim.seed.rds" - OUBM (multivariate OUBM) with regimes (for each Ellenberg value) 

* "OU1OU.output.txt"  "OU1OU.rds"  "OU1OU.seed.rds" - OUBM (multivariate OUOU) 

* "OUOUestim.output.txt"  "OUOUestim.rds"  "OUOUestim.seed.rds" - OUBM (multivariate OUOU) with regimes (for each Ellenberg value) 


* "Basic.model.outputs.for.SI.table_short2.txt" - The main model parameters presented for the 7 models above, which demontrate
more traditional usage of these models in the package (i.e. without heavy customisation of the A and Syy matrices).


Outputs and seeds for the models that were the focus of the manuscript 
(i.e. those that carefully select and define the A and Syy matrices).

* "_OUOU.start.Di" - folder containing the 100 starting models (with seed numbers) for Syy=Diagonal                              
* "OUOU.start.UT" - folder containing the 100 starting models (with seed numbers) for Syy=UpperTri 

Folders containing the 100 outputs and seeds for models 1 to 6 with Syy=Diagonal
* "_OUOU.model1.Di"  "_OUOU.model2.Di"  "_OUOU.model3.Di"                            
* "_OUOU.model4.Di"  "_OUOU.model5.Di"  "_OUOU.model6.Di"  

Folders containing the 100 outputs and seeds for models 1 to 6 with Syy=Diagonal               
* "OUOU.model1.UT"  "OUOU.model2.UT"  "OUOU.model3.UT"                             
* "OUOU.model4.UT"  "OUOU.model5.UT"  "OUOU.model6.UT"   


* "key.param.tabs.all.models_firstlook.csv"
For all 1200 main model runs fit in the study, this provides the Model.name, Model.number (i.e. run number), LogLiklihood, DOF	
M2LogLiklihoods, AIC, AICc, BIC, Rsquared


We found that the model with the lowest AICc was within model 6 with Σyy diagonal. 
However, we then noticed that the best model for the alternative model 6 (with Σyy upper–triangular) possessed a 
lower log-likelihood score than model 6 Σyy diagonal, despite the former being more complex. 

# Model.name	          Model.number LogLiklihood	DOF	M2LogLiklihoods	    AIC	        AICc	        BIC	        Rsquared
# OUOU.model6.Di.output	      79       -9271.035517	60	18542.07103	    18662.07103	18663.55072	19053.19855	0.102184147
# 
# OUOU.model6.UT.output       92       -35792.64542	66	71585.29085	    71717.29085	71719.08077	72147.53111	0.008681844

This should not happen if things are running correctly, and therefore informs us that the numerical optimizer 
has failed, having arrived at a worse local optimum of the log-likelihood surface than the simpler model. 

We therefore decided to use model 6 Σyy diagonal output as a starting point for 
a new run of model 6 Σyy upper–triangular (using the start_point_for_optim=list argument in ouchModel().
These are the outputs (and seed) for that reanalysed model:

* "OUOU.model6.UT_reanalysis.output.txt"  "OUOU.model6.UT_reanalysis.rds"  "seed_OUOU.model6.UT_reanalysis.rds"            


* "Optima_model6UT_reanalysis.pdf" - A figure showing evolutionary optimum values for each trait in this best fitting model	         


* key.param.tabs.all.models_secondlook.csv
For all model runs fit in the study (including OUOU.model6.UT_reanalysis.output, the best model). This provides the Model.name, 
Model.number (i.e. run number), LogLiklihood, DOF, M2LogLiklihoods, AIC, AICc, BIC, Rsquared


* "key.param.data.frame.best.models.csv"   
For the single best fitting model of each model type, this provides the Model.name, 
Model.number (i.e. run number), LogLiklihood, DOF, M2LogLiklihoods, AIC, AICc, BIC, Rsquared


* "Main.model.outputs.for.SI.table_short2.txt" - The main model parameters presented for the best fitting run of each of the 6 main
models in the study (which were briefly shown in "key.param.data.frame.best.models.csv")


* "BStrap_OUOU.model6.UT_reanalysis" - the 100 Bootstrap runs where estimated.model = OUOU.model6.UT_reanalysis but no starting point was set.
Contains all outputs and seeds for each run.


* "BStrap2_OUOU.model6.UT_reanalysis_" - the 100 Bootstrap 2 runs where estimated.model = OUOU.model6.UT_reanalysis but Start_point_for_optim 
was set to the lowest AICc OUOU.model6.Di.output model. Contains all outputs and seeds for each run.
          

* "Bootstrap.output.summary_v3.txt" - This contains the confidence intervals for $mPsi, $corr.matrix and $halflives
dervived from both sets of bootstrap simulations performed above (i.e. for BStrap_OUOU.model6.UT_reanalysis and BStrap2_OUOU.model6.UT_reanalysis_).
